# Hands-on L11: AWS Core Services (S3, Glue, CloudWatch, Athena)

This project demonstrates the use of essential AWS services including S3, IAM, Glue, CloudWatch, and Athena to query and analyze an E-Commerce sales dataset. The workflow covers ingesting raw data, cataloging it using a Glue crawler, and running analytical SQL queries in Athena to uncover key business insights.

---

## Dataset
Source: "Unlock Profits with E-Commerce Sales Data"  
Kaggle Link: https://www.kaggle.com/datasets/thedevastator/unlock-profits-with-e-commerce-sales-data  

The dataset was uploaded into an S3 bucket and later crawled into a structured table using AWS Glue.

---

## AWS Workflow Overview

| Step | AWS Service | Description |
|------|-------------|-------------|
| 1 | Amazon S3 | Created raw and processed storage buckets, uploaded CSV data |
| 2 | IAM | Created IAM role with S3 + Glue permissions for crawler execution |
| 3 | AWS Glue Crawler | Crawled S3 raw data and generated schema metadata into the Data Catalog |
| 4 | CloudWatch Monitoring | Verified crawler execution logs and job success |
| 5 | Amazon Athena | Queried the structured table generated by Glue |

---
### 1.Cloudwatch
<img width="940" height="493" alt="image" src="https://github.com/user-attachments/assets/f6f4a68f-f8bc-42f7-9e2a-aad1b4f761b1" />

### 2. IAM Role
<img width="940" height="499" alt="image" src="https://github.com/user-attachments/assets/67b39bf2-bf0c-4273-b180-0a18a28c7ce2" />

### 3. Creating S3 Buckets
<img width="940" height="469" alt="image" src="https://github.com/user-attachments/assets/5da20b4d-d614-4e43-9c8b-02997290e714" />




## SQL Queries Executed in Athena

### Query - 1
<pre> ```SELECT 
    date_parse("Date", '%m-%d-%y') AS order_date,
    SUM(CAST(Amount AS double)) OVER (
        ORDER BY date_parse("Date", '%m-%d-%y')
        ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS cumulative_sales
FROM "handsonoutputdb"."raw"
WHERE year(date_parse("Date", '%m-%d-%y')) = 2022
ORDER BY order_date
LIMIT 10; ``` </pre>
### Output
<img width="940" height="487" alt="image" src="https://github.com/user-attachments/assets/b529c072-36a9-445d-a8b1-1b4b0cf19936" />

### Query - 2
<pre> ```SELECT 
    "ship-state" AS state,
    SUM(CAST(Amount AS double) * -1) AS total_negative_profit
FROM "handsonoutputdb"."raw"
WHERE Status = 'Cancelled'
GROUP BY "ship-state"
ORDER BY total_negative_profit ASC
LIMIT 10; ``` </pre>
### Output
<img width="940" height="491" alt="image" src="https://github.com/user-attachments/assets/3e486e6a-3324-4082-b357-5d909306f6cb" />

### Query - 3
<pre> ```SELECT 
    Category AS sub_category,
    ROUND(SUM(CAST(Amount AS double)) / NULLIF(SUM(CAST(Qty AS double)), 0), 2) AS avg_revenue_per_item,
    COUNT(DISTINCT "Order ID") AS total_orders
FROM "handsonoutputdb"."raw"
GROUP BY Category
ORDER BY avg_revenue_per_item DESC
LIMIT 10; ``` </pre>
### Output
<img width="940" height="486" alt="image" src="https://github.com/user-attachments/assets/c324229f-e975-4a86-9a5e-f00a28b7cccf" />

### Query - 4
<pre> ```SELECT Category,
	product_name,
	total_profit,
	rank_within_category
FROM (
		SELECT Category,
			SKU AS product_name,
			SUM(CAST(Amount AS double)) AS total_profit,
			RANK() OVER (
				PARTITION BY Category
				ORDER BY SUM(CAST(Amount AS double)) DESC
			) AS rank_within_category
		FROM "handsonoutputdb"."raw"
		GROUP BY Category,
			SKU
	) AS ranked_data
WHERE rank_within_category <= 3
ORDER BY Category,
	total_profit DESC
LIMIT 10; ``` </pre>
### Output
<img width="940" height="485" alt="image" src="https://github.com/user-attachments/assets/6c17bda0-83bd-4947-8f46-596c0cedef41" />

### Query - 5
<pre> ```WITH monthly_summary AS (
    SELECT 
        date_trunc('month', date_parse("Date", '%m-%d-%y')) AS month,
        SUM(CAST(Amount AS double)) AS total_sales,
        SUM(CAST(Amount AS double)) AS total_profit
    FROM "handsonoutputdb"."raw"
    GROUP BY 1
)
SELECT 
    month,
    total_sales,
    total_profit,
    ROUND(
        (total_sales - LAG(total_sales) OVER (ORDER BY month)) / 
        NULLIF(LAG(total_sales) OVER (ORDER BY month), 0) * 100, 2
    ) AS sales_growth_pct,
    ROUND(
        (total_profit - LAG(total_profit) OVER (ORDER BY month)) / 
        NULLIF(LAG(total_profit) OVER (ORDER BY month), 0) * 100, 2
    ) AS profit_growth_pct
FROM monthly_summary
ORDER BY month
LIMIT 10; ``` </pre>
### Output
<img width="940" height="490" alt="image" src="https://github.com/user-attachments/assets/f468f8f2-d472-4f8b-ba14-82613431e571" />



